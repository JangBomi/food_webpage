<?php include 'menu_bar.html'; ?>


    <p style="font-size: 30px; font-weight: bold;"> 누적 조회수 순위 </p>
    <?php

          include 'db_info.php';
          $resultViewName = array();
          $resultViewRank = array();
          $resultViewNum = array();
          $resultPic = array();

          $viewsql = "select A.RCP_NM, A.ATT_FILE_NO_MAIN, B.view_num, dense_rank() over(order by B.view_num desc) as view_rank from recipe AS A INNER JOIN view_table AS B  ON B.view_index = A.RCP_INDEX limit 10";


          $result=mysqli_query($mysqli,$viewsql);

          while($row=mysqli_fetch_assoc($result)){
                $resultViewName[]=$row["RCP_NM"];
                $resultViewRank[]=$row["view_rank"];
                $resultViewNum[]=$row["view_num"];
                $resultPic[]=$row["ATT_FILE_NO_MAIN"];
          }

             $num=count($resultViewName);

             for($i=0;$i<$num;$i++){
                             ?>

    <div class="input-group col-xs-12" style="margin-top:1rem; box-sizing:border-box; width:40%; height:fit-content; border: 1rem; border-color: rgb(245, 150, 166); border-radius: 1rem; padding: 1rem;">

        <p style="font-size: 12px; font-weight: bold;"> <?php echo $resultViewRank[$i] ?> 등 </p>
        <a style="font-size: 20px; font-weight: bold;"  href="food_recipe.php?recipe_food_name=<? echo $resultViewName[$i] ?>" > <?php echo $resultViewName[$i] ?></a>
        <p style="font-weight: bold;"> 조회수 : <?php echo $resultViewNum[$i] ?> </p>

        <style type="text/css">
            a:link { color: black; text-decoration: none;}
            a:visited { color: black; text-decoration: none;}
            a:hover { color: red; text-decoration: underline;}
        </style>

    </div>



    <?php
                         }




        ?>

    <p style="font-size: 30px; font-weight: bold;"> 최근 조회된 레시피 </p>
    <?php

                        include 'db_info.php';
                        $resultViewName = array();
                        $resultViewRank = array();
                        $resultViewNum = array();
                        $resultViewPerRank = array();

           $viewsql = "select A.RCP_NM, B.late_view, rank() over(order by B.late_view desc) as view_rank from recipe AS A INNER JOIN view_table AS B  ON B.view_index = A.RCP_INDEX limit 10";

                         $result=mysqli_query($mysqli,$viewsql);

            while($row=mysqli_fetch_assoc($result)){
                $resultViewName[]=$row["RCP_NM"];
                $resultViewRank[]=$row["view_rank"];
                $resultViewPerRank[] = $row["view_percentrank"];
                $resultViewNum[]=$row["late_view"];

            }

             $num=count($resultViewName);

             for($i=0;$i<$num;$i++){
                             ?>

    <div class="input-group col-xs-12" style="margin-top:1rem; box-sizing:border-box; width:40%; height:fit-content; border: 1rem; border-color: rgb(245, 150, 166); border-radius: 1rem; padding: 1rem;">

        <p style="font-size: 12px; font-weight: bold;"> <?php echo $resultViewRank[$i] ?> 등 </p>
        <a style="font-size: 20px; font-weight: bold;"  href="food_recipe.php?recipe_food_name=<? echo $resultViewName[$i] ?>" > <?php echo $resultViewName[$i] ?></a>
        <p style="font-weight: bold;"> 최근 조회 시간 : <?php echo $resultViewNum[$i] ?> </p>


        <style type="text/css">
            a:link { color: black; text-decoration: none;}
            a:visited { color: black; text-decoration: none;}
            a:hover { color: red; text-decoration: underline;}
        </style>

    </div>



    <?php
                         }
                          mysqli_close($mysqli);

?>
</div>
</body>
</html>